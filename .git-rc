#!/bin/bash

# Git aliases. source me from .bashrc!

if [ -n "$ZSH_VERSION" ]; then
  dir="$(dirname $0)"
else
  dir="$(dirname "${BASH_SOURCE[0]}")"
fi

[ -s "$dir/.gitcomplete" ] && source "$dir/.gitcomplete"
[ -s "$dir/.git-completion.bash" ] && source "$dir/.git-completion.bash"

append_to_path() {
  for arg in "$@"; do
    if [ -d "$arg" ]; then
      export PATH="$PATH:$arg"
    fi
  done
}

append_subdir_to_path() {
  append_to_path "$dir/$1" "$dir/$1/aliases"
}

append_to_path "$dir" "$dir/aliases" "$dir"/github

append_subdir_to_path bisect
append_subdir_to_path branch
append_subdir_to_path cherry-pick
append_subdir_to_path commit
append_subdir_to_path conflicts
append_subdir_to_path diff
append_subdir_to_path github
append_subdir_to_path graph
append_subdir_to_path help
append_subdir_to_path log
append_subdir_to_path merge-base
append_subdir_to_path mv
append_subdir_to_path rebase
append_subdir_to_path remote
append_subdir_to_path rev-list
append_subdir_to_path rm
append_subdir_to_path status

# Don't try to remove NFS bookkeeping files when running git-copy-diffs
export GIT_COPY_DIFFS_PRESERVE_UNTRACKED='.nfs000*'

export oh="origin/HEAD"
export h="HEAD"
export pr="origin/pr"

alias gcd="g cd"
alias gf="git fetch"
alias gfo="git fetch origin"

alias gacpc="g acpc"
alias gbd="git branch -d"
alias gbD="git branch -D"
alias gbdf="git branch -D"
alias gd="git diff"
alias gdc="gd --cached"
alias gdh="git diff HEAD"
alias gs="git status"
alias gb="g b"
alias gbu="g bu"
alias gbr="g br"
alias gh="g h"
alias grb="g rb"
alias gl="git lg"
alias gls="git ls-files"
alias gmv="g mv"
alias gac="g ac '%h'"
alias gng="git --no-pager grep"
alias gg="git graph"
alias ggc="git graph-commits"
alias ggp="git graph-pretty"
alias ggn="git graph -n"
#alias gln="gn graph -n"
alias gln="g lg"

alias gc="git commit"
alias gcm="git commit -m"
alias gca="git commit -a"
alias gcam="git commit -a -m"

alias garc='git arc'
alias gaurc='git aurc'
alias guu='git conflicting'

alias grt='cd $(git root)'
alias gr="git remote -vv"
alias gsh="gn sh"  # git-show-short, no pager
alias rmu="git ls-files --other --exclude-standard | xargs rm -f"
alias snippets='git log --since "8days" --oneline --author $USER'

alias gss="git stash save"
alias gsa="git stash apply"
alias gsp="git stash pop"
alias gsl="gn sl"
alias gss="g ss"

# Source this repository's `.gitconfig` file from your global `.gitconfig`.
git config --global include.path "$dir"/.gitconfig
